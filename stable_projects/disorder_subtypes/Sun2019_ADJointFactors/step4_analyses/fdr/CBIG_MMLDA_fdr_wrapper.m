% FDR correction for all p values in our paper.
%
% Written by Nanbo Sun and CBIG under MIT license: https://github.com/ThomasYeoLab/CBIG/blob/master/LICENSE.md

clear('all');

p_10foldCV = [2.07070741778782e-05 ...
0.0369183037868885 ...
0.00447403666057892 ...
0.0440814279686049 ...
0.000190379245466227 ...
0.484849134192369 ...
0.00947332619888315 ...
0.283851865297338 ....
0.000254358831771616];

p_apmci_atrophy_cognitive = [
0.137906080751892 ...
0.228315433420609 ...
0.0267631957111406 ...
0.559345796315924 ...
0.346939315219088 ...
0.220907207228411 ...
0.0437996816132597 ...
0.0424862044030704 ...
0.000999563795284974];

p_mci_tau_reg_age_sex = [
0.00186860136908864 ...
0.0124811151724092 ...
0.178472222421286 ...
0.943028082443334 ...
0.287186100613460 ...
0.479299528034604 ...
0.00288709591269910 ...
0.00200071975235606 ...
0.460324580018283];

p_apmci_tau_reg_age_sex = [
0.0492321219397770 ...
0.462873608214162 ...
0.178907705310314 ...
0.548872855363889 ...
0.592655577894631 ...
0.865987941274228 ...
0.0107467284149829 ...
0.223084979398332 ...
0.110389323980694];

p_mci_corr_perm = [
0.0858914108589141 ...
0.0126987301269873 ...
0.0168983101689831 ...
];

p_characteristic = [
0.000229316112387969 ...
0.441410819236736 ...
0.914355113535424 ...
0.159508978513623 ...
0.970532779868864 ...
0.818339516018940];

p_all = [p_10foldCV, p_apmci_atrophy_cognitive, p_mci_tau_reg_age_sex, ...
p_apmci_tau_reg_age_sex, p_mci_corr_perm, p_characteristic];
[~, thre] = FDR(p_all, 0.05);
disp('FDR threshold:')
disp(thre)