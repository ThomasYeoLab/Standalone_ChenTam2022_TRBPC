# Post-polarLDA Analyses
**This folder is mainly for CBIG internal use.**

The sub-folders here contain the analyses that we performed after the polarLDA step. Some of the figures appearing in our paper were generated by functions in some folders here. Since many of these folders depend on certain files that are not released publicly, it will be hard for external users to run the code directly. However, we still release the code in the hope that you do not need to start from scratch when performing similar analyses.

----
## What Does Each Folder Do?
1. `behavioralAssociation` (Figure 5). This folder performs canonical correlation analysis (CCA) between factor loadings and behavioral scores to investigate the associations between latent factors and behavioral symptoms.
2. `bootstrapping` (Figure 2B-2C, Figure 4 & Figure S2). This folder performs bootstrapping, re-estimates factors from the bootstrapped samples, and computes bootstrapped z-scores to obtain statistically significant RSFC patterns. Furthermore, this folder also includes functions to plot significant RSFC patterns (Figure 2B), RSFC patterns shared across all factors (Figure 4B), as well as RSFC patterns unique to each factor (Figure S2).
2. `characteristics` (Figures S3). This folder investigates the associations between latent factors and participants' characteristics (i.e., age, sex, IQ & head motion).
3. `factorDistribution` (Figures 3). This folder visualizes factor compositions of ASD participants.
4. `factorHierarchy`. This folder quantifies the hierarchical structure of latent factors. In other words, it explores the possibility that two factors in the (K+1)-factor model were splits of one factor in the K-factor model (while the other factors remained the same). No figure in the paper is generated by functions in this folder.
5. `kmeans` (Table S9 & Figure S4). This folder performs k-means clustering on z-normalized RSFC of ASD participants in ABIDE-II+GENDAAR, and compares the k-means clusters behavioral associations with the latent factors.
5. `relevanceForTraditionalCaseControlAnalyses` (Figures S5 & S6). This folder compares RSFC between all ASD and control participants in ABIDE-I, as well as RSFC between ASD and control participants in each factor subgroup. Statistical significance is tested using network-based  statistic.
6. `splitHalf` (Table S10). This folder contains the script to re-estimate factors on the two random splits of ABIDE-II+GENDAAR ASD participants.
6. `utilities`. This folder contains some helper functions that are called by other functions in multiple folders.

